# Implementation Progress Log

This file contains implementation notes for shooter.nvim features.
Format: [YYYY-MM-DD HH:MM] Shot <number> - <Feature Title>

---

[2026-01-22 08:10] Shot 240 - 2026-01-18 - shooter.nvim
- Changed <space>t to only show files directly in plans/prompts/ by default
- Subfolders (archive, backlog, done, etc.) only shown when filter is applied
- Fixed in lua/shooter/telescope/helpers.lua:
  * get_prompt_files(): uses *.md (root only) when no filter, **/*.md with filter
  * get_all_repos_prompt_files(): same pattern for multi-repo picker

[2026-01-22 01:05] Shot 239 - 2026-01-18 - nvim next action commands
- Fixed git remote parsing truncating repo names with dots
- Bug: Pattern `[^/%.]+` stopped at `.` so `shooter.nvim` became `shooter`
- Fixed in lua/shooter/history/init.lua:
  * Changed patterns to `(.+)%.git$` to capture full repo name
  * Added fallback patterns for remotes without .git suffix
- Now correctly parses: git@github.com:divramod/shooter.nvim.git â†’ divramod/shooter.nvim

[2026-01-22 00:25] Shot 237 - 2026-01-18 - nvim next action commands
- Fixed move commands (archive, backlog, etc.) broken when in Oil
- Bug: commands/move.lua was calling non-existent function
  * Wrong: require('shooter.core.files').move_file_to_folder(folder)
  * Right: require('shooter.core.movement').move_to_archive() etc.
- Fixed in lua/shooter/commands/move.lua:
  * Now uses shooter.core.movement module directly
  * Calls existing wrapper functions (move_to_archive, move_to_backlog, etc.)

[2026-01-22 00:20] Shot 236 - 2026-01-18 - nvim next action commands
- Added 'd' key to delete shot in open shots picker (<space>o)
- Implementation in lua/shooter/telescope/actions.lua:
  * delete_shot(pb, target_file, refresh_fn) - delete selected shot with confirm
  * Handles loading buffer if file not already open
  * Refreshes picker after deletion
- Wired up in lua/shooter/telescope/pickers.lua with refresh callback
- Updated help.lua with 'd = delete shot' in picker keys
- Note: telescope/pickers.lua and actions.lua now slightly over 200 lines (tech debt)

[2026-01-22 00:10] Shot 235 - 2026-01-18 - nvim next action commands
- Added tmux command wrappers with <space>U prefix
- Created lua/shooter/tmux/wrapper.lua module:
  * zoom_toggle() - Toggle pane zoom (like M-z)
  * edit_in_vim() - Edit pane content in vim
  * git_status_toggle() - Toggle git status display
  * lightswitch() - Toggle light/dark theme
  * kill_other_panes() - Kill all except current
  * reload_session() - Reload tmuxp session
  * delete_session() - Session delete picker
  * smug_load() - Load smug session
  * yank_to_vim() - Yank pane to vim buffer
  * choose_session() - Tmux session chooser
  * switch_last() - Switch to last client
- Added 11 ShooterTmux* commands in commands.lua
- Added keymaps: <space>U{z,e,g,i,o,r,d,s,y,c,p}
- Updated help.lua with TMUX WRAPPER section

[2026-01-21 23:45] Shot 234 - 2026-01-18 - nvim next action commands
- Fixed filename format to use date only, not datetime with time
- Problem: Files created as "2026-01-21 22:57:49_slug.md" (with time/spaces)
- Expected: "2026-01-21_slug.md" (date only, underscore separator)
- Fixed in lua/shooter/core/files.lua:
  * generate_filename() now uses utils.get_date() instead of get_timestamp()
  * Format: YYYY-MM-DD_slug.md

[2026-01-21 23:05] Shot 233 - 2026-01-18 - nvim next action commands
- Fixed ShooterCreate (<space>n) not prompting for feature name
- Problem: When called without args, defaulted to "New Shot File"
- Fixed in lua/shooter/commands.lua:
  * Now uses vim.ui.input({ prompt = 'Feature title: ' }) when no args
  * Only creates file after user enters a title
  * If user cancels or enters empty string, no file is created
- Pattern follows existing implementation in core/repos.lua:96

[2026-01-21 21:45] Shot 227 - 2026-01-18 - nvim next action commands
- Added tmux pane visibility toggle with <space>r1-4
- Created lua/shooter/tmux/panes.lua:
  * toggle(pane_index) - hides/shows pane by index
  * is_hidden(pane_index) - checks if pane is currently hidden
  * get_status() - returns all hidden pane states
  * Uses tmux break-pane to hide (moves to background window)
  * Uses tmux join-pane to show (brings back to current window)
- Added ShooterPaneToggle1-9 commands
- Keymaps: <space>r1-4 = toggle pane visibility
- Moved resend commands to <space>R1-4 (uppercase R)
- Added tests in tests/tmux/panes_spec.lua
- Updated help.lua with new PANE VISIBILITY and RESEND sections

[2026-01-21 21:40] Shot 226 - 2026-01-18 - nvim next action commands
- Fixed munition import to ensure exactly one empty line after inserted shots
- Problem: Multiple empty lines could appear after imported content
- Fixed in lua/shooter/inbox/picker.lua:
  * Trim trailing whitespace from shot_content with gsub('%s+$', '')
  * Changed gmatch pattern from '[^\n]*' to '[^\n]+' (skip empty lines)
  * Guarantees exactly one trailing empty line per shot

[2026-01-21 21:35] Shot 222 - 2026-01-18 - nvim next action commands
- Fixed munition import to always insert shots at line 3
- Problem: Too many empty lines between title and first imported shot
- Fixed in lua/shooter/inbox/picker.lua:
  * Removed leading empty line from shot_lines array
  * Added trailing empty line after content instead
  * Ensure line 2 is empty between title and first shot
  * Always insert at index 2 (line 3)
- Format now: Line 1 = # Title, Line 2 = empty, Line 3 = ## shot N

[2026-01-21 21:30] Shot 217 - 2026-01-18 - nvim next action commands
- Fixed format of imported shots in munition feature
- Problem: Multi-line content was being passed as single string
- Fixed in lua/shooter/inbox/picker.lua:
  * Split content into individual lines using gmatch('[^\n]*')
  * Each line added separately to shot_lines array
- Empty line now appears before each shot header as expected

[2026-01-21 21:25] Shot 210 - 2026-01-18 - nvim next action commands
- Added longest/shortest prompt statistics to analytics
- Modified lua/shooter/analytics.lua:
  * Extended calculate_stats() to track extremes for chars, words, sentences
  * Each extreme tracks value, shot number, and source file
  * Added "## Prompt Length Extremes" section to report
- Added 3 tests in tests/core/analytics_spec.lua

[2026-01-21 20:35] Shot 191 - 2026-01-18 - nvim next action commands
- Added configurable sound notifications when shots are sent
- Implementation in lua/shooter/sound.lua:
  * play() - plays configured sound when enabled
  * play_file(filepath, volume) - plays custom sound one-off
  * test() - tests sound configuration
- Added config options: sound.enabled, sound.file, sound.volume
- Platform support: macOS (afplay), Linux (paplay)
- Added ShooterSoundTest command
- Added tests in tests/core/sound_spec.lua

[2026-01-21 20:25] Shot 194 - 2026-01-18 - nvim next action commands
- Added ShooterUndoLatestSent command and <space>u keybinding
- Implementation in lua/shooter/core/shot_actions.lua:
  * undo_latest_sent_shot() finds shot with latest timestamp
  * Changes "## x shot N (timestamp)" back to "## shot N"
- Added 3 tests in tests/core/shot_actions_spec.lua

[2026-01-21 20:20] Shot 197 - 2026-01-18 - nvim next action commands
- Added timestamp to history filenames: shot-<number>-<yyyymmdd>_<hhmmss>.md
- Created history/migrate.lua for batch migration
- Added ShooterMigrateHistory command
- Added 25 tests in tests/core/history_spec.lua
